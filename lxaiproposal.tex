\documentclass{lxaiproposal}

\usepackage[english]{babel}

\PassOptionsToPackage{hyphens}{url}\usepackage{hyperref}
\usepackage{times}
\usepackage{array}
\usepackage{color}
\usepackage{epsfig}
\usepackage{pifont}
\usepackage{pifont}
\usepackage{caption}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{caption}
\usepackage{amssymb}
\usepackage{pdfpages}
\usepackage{makecell}
\usepackage{booktabs}
\usepackage{latexsym}
\usepackage{booktabs}
\usepackage{colortbl}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{subcaption}

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}

\title{Virtual Node Graph Neural Networks for Hypothetical Metal Organic Framework Inference Tasks\\ \large Summer 2023 PURA Salary Award Proposal}

\author{\coord{Sidharth Baskaran}{}{1}}

\address{\affil{1}{
College of Computing, Georgia Institute of Technology}}

\email{sidharth.baskaran@gatech.edu}

\begin{document}
\maketitle

\section*{Project Overview}

In materials science, molecular property prediction has a range of applications, including
energy catalyst optimization and drug materials discovery. Graph neural networks (GNNs) have proven to be effective for such inference tasks; structurally representing molecules as graphs and scaling to $O(n)$ runtime complexity as opposed to $O(n^3)$ for one of the most popular conventional methods, density-functional theory (DFT). Metal-organic frameworks (MOFs) are porous materials consisting of metal clusters linked by organic components, and pose a challenge for GNNs due to difficulty in expressing pores in graph structures. We propose a model-agnostic method incorporating virtual nodes into molecular graphs for improved expressiveness and performance on MOF prediction tasks that has shown promising results to date.
This project is undertaken under mentorship of Dr. Victor Fung (\textit{Georgia Tech CSE}) and in collaboration with Dr. Guojing Cong (\textit{Oak Ridge National Laboratory}).

\subsection*{Message-Passing Graph Neural Networks}

Graph neural networks (GNNs) have become increasingly popular in the materials science space, and can be used on a variety of tasks, including property inference, synthesis prediction, and structure generation\cite{Reiser2022}. In principle, GNNs are able to perform convolutions over arbitrary inputs with standardized feature dimensions, and offer the advantage of working with atomic structures that easily translate to graphs. A graph $G=(v,e,u)$ is represented by a set of nodes $v$, edges $e$, and global properties $u$. Nodes are assigned attributes ${\bf x}\in \mathbb{R}^{n}$ and edges ${\bf e}\in \mathbb{R}^m$. Message-passing (MP) GNNs propagate information between adjacent nodes $v_i,v_j$ across $e_{ij}$, a concept used in modern graph convolutional operators such as in CGCNN\cite{Xie_2018} which perform complex node attribute update schemes of the form in \ref{eq:mpupdate} where $\bigoplus$ is a differentiable, permutation-invariant reduction such as mean, max, sum and $\gamma,\phi$ are multilayer perceptrons (MLPs).

\begin{equation}
    \mathbf{x}_i^{(k)} = \gamma^{(k)} \left( \mathbf{x}_i^{(k-1)}, \bigoplus_{j \in \mathcal{N}(i)} \, \phi^{(k)}\left(\mathbf{x}_i^{(k-1)}, \mathbf{x}_j^{(k-1)},\mathbf{e}_{j,i}\right) \right)
    \label{eq:mpupdate}
\end{equation}

Each atom in a structure is a node in the graph, and is assigned a vector of node attributes encoding chemical and neighboring properties. Bonds are represented by edges and are assigned vectorial attributes encoding spatial information (\ref{fig:messagep}). Molecular property inference involves scalar-valued predictions given graph inputs. A common pipeline involves a series of convolutional layers followed by a set of fully-connected classification layers to provide a global readout value (\ref{fig:pipeline}).

\begin{figure*}[h]
    \centering
    \includegraphics[width=\textwidth]{mdl-vn-pipeline.drawio.png}
    \caption{Volumetric methane uptake inference pipeline with virtual nodes in MatDeepLearn\cite{fung2021benchmarking}}
    \label{fig:pipeline}
\end{figure*}

\begin{figure}
    \centering
    \includegraphics[scale=0.25]{unitcell-vn.drawio.png}
    \caption{Unit cell with virtual node mesh}
    \label{fig:unitcell}
\end{figure}

\begin{figure*}[h]
    \centering
    \includegraphics[scale=0.2]{graph-rep-vn.drawio.png}
    \caption{Selective message passing}
    \label{fig:messagep}
\end{figure*}

\subsection*{hMOF Dataset}

Metal-organic frameworks (MOFs) are composed of modular building blocks that form crystal structures, and are of interest due to their porous nature among other properties. The space of  MOFs is large due to their modular structure, which allows for millions of possible structures. The hypothetical metal-organic framework (hMOF) generation procedure generates every possible structure under constraints to produce 137,953 hMOFs, using building blocks of naturally occurring MOFs. The global properties for each structure are surface area, pore volume, pore-size distribution, powder X-ray diffraction pattern, and methane-adsorption capability\cite{wilmer2012large}.

\subsection*{Virtual Nodes for Graph Structures}

Crystal structures are an infinite system GNNs use the graph of the smallest repeating unit (unit cell) as an approximation for the system, described by a set of basis vectors. Virtual nodes are throughout the unit cell parallepiped to form a controllable mesh\ref{fig:unitcell}. Each virtual node is described by a node attribute vector and is connected via edges to real and virtual nodes\ref{fig:messagep}.

\section*{Project objective and goals}

\section*{Research Plan and Methods}

\subsection{Preliminary Results}

\subsection{Outperforming Baseline Results}

\subsection{Incorporating Heterogeneous Graphs}

\section*{Related Work}

Machine learning-based approaches to predict methane-adsorption exist, but do not utilize GNNs, rather creating structural fingerprint vectors encoding spatial and chemical information. Deep neural networks are then used to map these fingerprints to predicted methane-adsorption. \cite{gurnani2021interpretable}. 
Virtual nodes have been used in GNNs for materials property inference, but for different use cases including full phonon\cite{https://doi.org/10.48550/arxiv.2010.09435} and electron density prediction\cite{jorgensen2022equivariant}.

\section*{Projected Outcome and Implications}

Anand Radhakrishnan and I will arrive on Sunday, November 13, 2022, and return to Atlanta on Thursday, November 17, 2022. We plan on attending many events held at the conference and thus chose to leave Atlanta on Sunday rather than on Monday morning. This has the added benefit of protecting us from unforeseen events such as flight cancellations.

\section*{Acknowledgments}

NERSC DOE HPC resources, PACE supercomputer, CoC supercomputer. Grants if applicable.

\bibliographystyle{ieee_fullname}
\bibliography{references}

\end{document}